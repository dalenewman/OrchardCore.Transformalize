(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.registerHelper("fold","brace",function(t,i){function y(r){for(var u,e=i.ch,o=0;;){if(u=e<=0?-1:v.lastIndexOf(r,e-1),u==-1){if(o==1)break;o=1;e=v.length;continue}if(o==1&&u<i.ch)break;if(l=t.getTokenTypeAt(n.Pos(f,u+1)),!/^(comment|string)/.test(l))return u+1;e=u-1}}var f=i.line,v=t.getLine(f),l,p="{",w="}",o=y("{"),a,b,h,k,u,e,r,s,c;if(o==null&&(p="[",w="]",o=y("[")),o!=null){a=1;b=t.lastLine();n:for(u=f;u<=b;++u)for(e=t.getLine(u),r=u==f?o:0;;){if(s=e.indexOf(p,r),c=e.indexOf(w,r),s<0&&(s=e.length),c<0&&(c=e.length),r=Math.min(s,c),r==e.length)break;if(t.getTokenTypeAt(n.Pos(u,r+1))==l)if(r==s)++a;else if(!--a){h=u;k=r;break n}++r}if(h!=null&&f!=h)return{from:n.Pos(f,o),to:n.Pos(h,k)}}});n.registerHelper("fold","import",function(t,i){function u(i){var r,u,e,o,f;if(i<t.firstLine()||i>t.lastLine()||(r=t.getTokenAt(n.Pos(i,1)),/\S/.test(r.string)||(r=t.getTokenAt(n.Pos(i,r.end+1))),r.type!="keyword"||r.string!="import"))return null;for(u=i,e=Math.min(t.lastLine(),i+10);u<=e;++u)if(o=t.getLine(u),f=o.indexOf(";"),f!=-1)return{startCh:r.end,end:n.Pos(u,f)}}var r=i.line,e=u(r),s,f,o;if(!e||u(r-1)||(s=u(r-2))&&s.end.line==r-1)return null;for(f=e.end;;){if(o=u(f.line+1),o==null)break;f=o.end}return{from:t.clipPos(n.Pos(r,e.startCh+1)),to:f}});n.registerHelper("fold","include",function(t,i){function f(i){if(i<t.firstLine()||i>t.lastLine())return null;var r=t.getTokenAt(n.Pos(i,1));return/\S/.test(r.string)||(r=t.getTokenAt(n.Pos(i,r.end+1))),r.type=="meta"&&r.string.slice(0,8)=="#include"?r.start+8:void 0}var r=i.line,e=f(r),u,o;if(e==null||f(r-1)!=null)return null;for(u=r;;){if(o=f(u+1),o==null)break;++u}return{from:n.Pos(r,e+1),to:t.clipPos(n.Pos(u))}})});