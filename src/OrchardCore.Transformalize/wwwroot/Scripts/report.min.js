function removeUrlParameter(n,t){var u=n.split("?"),f,i,r;if(u.length>=2){for(f=encodeURIComponent(t)+"=",i=u[1].split(/[&;]/g),r=i.length;r-->0;)i[r].lastIndexOf(f,0)!==-1&&i.splice(r,1);return u[0]+(i.length>0?"?"+i.join("&"):"")}return n}function getUrlParameter(n){let i=new RegExp("[?&]"+n+"=([^&#]*)"),t=i.exec(window.location.search);return t?decodeURIComponent(t[1]):null}function bulkAction(n,t){var r=$(".bulk-action:checked").length,i;r>0&&($.blockUI({message:null,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff",baseZ:1021}}),i=$("#id_report"),i.attr("method","POST"),i.attr("action",server.bulkActionUrl),i.append($(".AntiForge").html()),i.append('<input type="hidden" name="ActionName" value="'+t+'" />'),i.append('<input type="hidden" name="ActionCount" value="'+controls.bulkActionLength+'" />'),i.append('<input type="hidden" name="ReturnUrl" value="'+window.location.href+'" />'),controls.submit(n))}function updateBulkActions(){var n=$(".bulk-action:checked").length,t=n===$(".bulk-action").length;$(".bulk-action-link").each(function(){var i=$(this),r=t?"All":$("#select-all:checked").length>0?n-1:n;controls.bulkActionLength=r;i.html(i.attr("rel")+' <span class="badge text-bg-dark">'+r+"<\/span>")})}function edit(n){const u=[];$(".field-check:checked").each(function(){u.push($(this).data("index"))});console.log(n+" fields:",u.join("."));let f=$("#id_h").val().split(".").filter(Boolean),t=$("#id_s").val().split(".").filter(Boolean),i=$("#id_f1").val().split(".").filter(Boolean),r=$("#id_f2").val().split(".").filter(Boolean),e=$("#id_o").val().split(".").filter(Boolean);n==="hide"?(f=_.union(f,u),u.length>0&&controls.setSort(""),f.forEach(function(n){var t=$("th[data-index='"+n+"']").index()+1;t>0&&($("th[data-index='"+n+"']").hide(),$("tr").each(function(){$(this).find("td:nth-child("+t+")").hide()}))}),t=_.difference(t,f),i=_.difference(i,f),r=_.difference(r,f),e=_.difference(e,f)):n==="search"?(t=_.union(t,u),i=_.difference(i,t),r=_.difference(r,t)):n==="facet"?(i=_.union(i,u),t=_.difference(t,i),r=_.difference(r,i)):n==="facets"?(r=_.union(r,u),t=_.difference(t,r),i=_.difference(i,r)):n==="clear"?(t=_.difference(t,u),i=_.difference(i,u),r=_.difference(r,u)):n==="order"&&(e=_.difference(e,f),controls.setSort(""));$("#id_h").val(f.join("."));$("#id_s").val(t.join("."));$("#id_f1").val(i.join("."));$("#id_f2").val(r.join("."));$("#id_o").val(e.join("."));console.log({hide:f,search:t,facet:i,facets:r,order:e});n!=="order"&&n!=="hide"&&controls.submit(server.entity.page===0?0:1)}function setColumnOrder(){var n=$("th[data-index]").map(function(){return $(this).attr("data-index")}).get().join(".");$("#id_o").val(n);console.log("column order: "+n)}var controls={setPage:function(n){$("#id_page").val(n)},submit:function(n){controls.setPage(n);$("#id_report").submit()},setSize:function(n){$("#id_size").val(n);controls.submit(1)},setSort:function(n){$("#id_sort").val(n)},lastChecked:null,bulkActionLength:0};$(document).ready(function(){var i="_Cleared",n,t=$(".shift-select");t.click(function(n){if(!controls.lastChecked){controls.lastChecked=this;return}if(n.shiftKey){var i=t.index(this),r=t.index(controls.lastChecked);t.slice(Math.min(i,r),Math.max(i,r)+1).prop("checked",controls.lastChecked.checked)}controls.lastChecked=this});$(".field-search").on("keypress",function(n){if(n.keyCode===13){n.preventDefault();let t=$(this).val();t!==""&&t!=="*"&&$("#id_last").val($(this).attr("name"));controls.submit(1)}});$("#id_report select").selectpicker({liveSearch:!0,deselectAllText:"Off",noneSelectedText:"All",noneResultsText:"Not Found",selectAllText:"On",selectedTextFormat:"count > 2",style:"btn-sm btn-light",width:"fit",sanitize:!1,showTick:!0});$("#id_report select").on("changed.bs.select",function(){n=this.name;controls.setPage(1);this.multiple&&$(this).val().length!==0||controls.submit(1)});$("#id_report select").css("visibility","visible");$(".form-control.date").datepicker({dateFormat:"yy-mm-dd"});$("#id_report").bind("submit",function(){$('input[type="text"]').each(function(){this.value=$.trim(this.value)});$("#id_submit").prop("disabled",!0);var t=parseInt($("#id_page").val());return t<=1&&$("#id_page").attr("disabled",!0),$("#id_report input").filter(function(){var n=$(this).val();return n==="*"||n===""}).attr("disabled",!0),$("#id_report select").each(function(){var t,r,u;n!==$(this).attr("name")&&n!==i&&(t=$("option:selected",this),r=t.length,r===0?$(this).attr("disabled",!0):r===1&&(u=$(t[0]).val(),(u===""||u==="*")&&$(this).attr("disabled",!0)))}),$("#busy").show(),!0});$("#id_clear").click(function(){n=i;$("#id_report select:not([multiple])").selectpicker("val","*");$("#id_report select[multiple]").selectpicker("deselectAll");$("#id_report select[multiple]").selectpicker("render");$("#id_report input:visible").val("");controls.submit(server.entity.page===0?0:1)});$(".sortable").click(function(){var n,t;$(this).toggleClass("btn-sort").toggleClass("btn-primary");$(this).siblings(".sortable").each(function(){$(this).hasClass("btn-primary")&&$(this).removeClass("btn-primary").addClass("btn-sort")});n="";$("td.sorter").each(function(){var t=$(this).attr("data-order-by"),i;t&&(i=0,$("a.sortable",$(this)).each(function(){if($(this).hasClass("btn-primary"))switch(i){case 0:n+=t+"a.";break;case 1:n+=t+"d."}i++}))});t=n.replace(/^\.+|\.+$/gm,"");console.log(t);controls.setSort(t);controls.submit(server.entity.page===0?0:1)});$(":checkbox[name=select-all]").click(function(){$(":checkbox[name=Records]").prop("checked",this.checked);updateBulkActions()});$(":checkbox[name=Records]").click(function(){updateBulkActions()});$('input[type="text"]').on("focus",function(){$(this).val()=="*"&&$(this).select()});$("table:first").dragtable({persistState:function(){setColumnOrder();edit("order")}});let r=getUrlParameter("last");if(r){let n=$('input[name="'+r+'"]');if(n.length){n.focus();let t=n[0],i=t.value.length;t.setSelectionRange(i,i)}}});